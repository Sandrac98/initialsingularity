<div class="toast toast-notification toast-success rounded-0 border-top-0" data-autohide="false">
    <div class="arrow-up arrow-success"></div>
    <div class="w-100 toast-capper bg-success"></div>
    <div class="toast-header bg-white text-dark">
        <strong class="mr-auto">Success!</strong>
        <button type="button" class="ml-2 mb-1 close text-dark" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="toast-body">
        {{ message }}
    </div>
</div>

<!-- Shopping Bag Toast (if there are shopping bag items) -->
{% if shopping_bag_items %}
<div class="toast toast-notification toast-bag rounded-0 border-top-0" data-autohide="false"> 
    <p class="logo-font bg-white py-1" style="color: #9f38f1;">Your Bag ({{ product_count }})</p>
    <div class="toast-body">
        {% for item in shopping_bag_items %}
        <div class="row">
            <div class="col-3 my-1">
                <a href="{% url 'product_details' item.product.id %}">
                    {% if item.product.image %}
                    <img class="img-fluid rounded" src="{{ item.product.image.url }}" alt="{{ item.product.name }}"></a>
                    {% else %}
                    <img class="img-fluid rounded" src="{{ MEDIA_URL }}.noimage.png" alt="{{ item.product.name }}"></a>
                    {% endif %}
            </div>
            <div class="col-9">
                <a href="{% url 'product_details' item.product.id %}">
                    <p class="my-0">{{ item.product.name }}</p>
                </a>
                <p class="my-0 small">Qty: {{ item.quantity }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="toast-footer">
        <p class="mt-3 mb-1">
            Total{% if free_delivery_amount > 0 %} (Exc. delivery){% endif %}:
            <span class="float-right">£{{ total|floatformat:2 }}</span>
        </p>
        {% if free_delivery_amount > 0 %}
        <p class="mb-0 p-2 shadow-sm text-center" style="color: #9f38f1;">
            Spend <strong>£{{ free_delivery_amount }}</strong> more to get free delivery!
        </p>
        {% endif %}
        <a href="{% url 'checkout' %}" class="btn btn-black" id="toast-button" style="padding: 10px;">
            <span class="text-uppercase">Secure Checkout</span>
            <span class="icon">
                <i class="fas fa-lock"></i>
            </span>
        </a>
    </div>
</div>
{% endif %}

{% block postloadjs %}
<script>
    // Find the toast elements
    const successToast = document.querySelector('.toast-success');
    const bagToast = document.querySelector('.toast-bag');

    // Function to hide the success toast
    function hideSuccessToast() {
        successToast.style.display = 'none';
    }

    // Automatically hide the success toast after 3000 milliseconds (3 seconds)
    setTimeout(hideSuccessToast, 3000);

    // Function to hide the shopping bag toast
    function hideBagToast() {
        bagToast.style.display = 'none';
    }

    // Automatically hide the shopping bag toast after 3000 milliseconds (3 seconds)
    setTimeout(hideBagToast, 3000);
</script>
{% endblock %}